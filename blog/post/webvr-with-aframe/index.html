<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>WebVR With A-Frame</title>
		<meta name="viewport" content="width=device-width">
		
		<link rel="stylesheet" href="https://manishraj.dev/blog/css/hybrid.css">
		<link rel="stylesheet" href="https://manishraj.dev/blog/css/style.css">
		<link rel="stylesheet" href="https://manishraj.dev/blog/css/colors-dark.css">

		
	</head>
	<body>
		<header id="header">
			<h1><a href="https://manishraj.dev/blog/">Blog</a></h1>
			<p></p>
		</header>

		<div id="page">
			<div id="sidebar">
				<nav>
	
		<ul class="nav">
			
				<li><a href="https://manishraj.dev/blog/post/"><span>Posts</span></a></li>
			
				<li><a href="https://manishraj.dev/blog/tags/"><span>Tags</span></a></li>
			
		</ul>
	
</nav>

			</div>

			<div id="content">
				
	<article class="post">
		<h1><a href="https://manishraj.dev/blog/post/webvr-with-aframe/">WebVR With A-Frame</a> </h1>

		<div class="post-content">

<h2 id="webvr">WebVR</h2>

<p>WebVR is an emerging technology that enables virtual reality experience to be delivered and experienced from within a web browser. WebVR is mostly composed of experimental Javascript APIs supported by browsers such as Firefox and Chrome and VR headsets such as Oculus Rift, Google Daydream etc.</p>

<p>WebVR can be used to build all kinds of VR experiences such as presentations, stories, walk-through guides, maps, architectural design demos, games and anything else one can envision.</p>

<h2 id="a-frame">A-Frame</h2>

<p>A-Frame is a WebVR framework that allows web developers to create VR experiences using simple declarative syntax and HTML-like elements. Check it out at <a href="https://aframe.io/">https://aframe.io/</a>.</p>

<h4 id="in-this-post-we-will-use-a-popular-webvr-framework-a-frame-to-build-a-simple-maze-game">In this post, we will use a popular WebVR framework &ldquo;A-Frame&rdquo; to build a simple maze game.</h4>

<p>The idea:</p>

<ol>
<li>Build a simple 3D maze with 2 exits</li>
<li>Drop user in the middle of the maze and allow user to move towards either exit</li>
</ol>

<h2 id="getting-started">Getting started</h2>

<p>We start with a simple template. Create a folder &ldquo;maze-vr&rdquo; and then create <code>index.html</code> file.</p>

<p><code>File: index.html</code></p>

<pre><code>&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Maze&lt;/title&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;script src=&quot;//aframe.io/releases/0.6.0/aframe.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;//cdn.rawgit.com/donmccurdy/aframe-extras/v3.11.4/dist/aframe-extras.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;game.js&quot;&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body class=&quot;a-body &quot;&gt;
    &lt;a-scene&gt;
    &lt;/a-scene&gt;
    &lt;a style=&quot;display: none;&quot;&gt;&lt;/a&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>I also included aframe-extras for physics and added another file <code>game.js</code> where we will add js code for the game.</p>

<p>Run and verify:</p>

<pre><code>cd maze-vr
python -m SimpleHTTPServer
</code></pre>

<p>Then go to: <a href="http://localhost:8000">http://localhost:8000</a></p>

<p>We should have a simple A-Frame scene up and running. A blank screen with no errors on console is what we&rsquo;re looking for at this point.</p>

<h2 id="start-adding-vr-components-to-a-scene">Start adding VR components to a-scene</h2>

<p>Now we&rsquo;ll go ahead and add a few components and configs to &lt;a-scene&gt; in <code>index.html</code> file.</p>

<p>Add ground, sky, user&rsquo;s perspective (camera) and enable physics and stats for the scene element.</p>

<pre><code>    &lt;a-scene 
      stats 
      physics=&quot;
        driver: worker; 
        workerFps: 60; 
        workerInterpolate: true; 
        workerInterpBufferSize: 2;
      &quot;&gt;
        &lt;a-sky color=&quot;#6EBAA7&quot;&gt;&lt;/a-sky&gt;
        &lt;!-- ground --&gt;
        &lt;a-grid static-body&gt;&lt;/a-grid&gt;
        &lt;a-entity 
            camera=&quot;userHeight: 1.6&quot; 
            universal-controls 
            kinematic-body
        &gt;
        &lt;/a-entity&gt;
    &lt;/a-scene&gt;
</code></pre>

<p>At this point, we should have a basic scene with ground, sky and user should be able to move using mouse and W-A-S-D keys. Something like this:</p>

<p><img src="https://manishraj.dev/blog/img/09/aframe_maze_vr_boot.gif"  style="width: 70%; margin: auto; display: block;"></p>

<h2 id="build-and-render-a-maze">Build and render a maze</h2>

<p>Folks at rosettacode.org have an entire page dedicated to maze generation algorithms so we used one of their JS implementation and modified it a bit. <a href="https://rosettacode.org/wiki/Maze_generation#JavaScript">https://rosettacode.org/wiki/Maze_generation#JavaScript</a></p>

<p>We also added two more functions to <code>game.js</code></p>

<ul>
<li>addWall: create a static-body A-frame entity with specified positions and dimensions</li>
<li>renderMaze: generate and render a maze on window load</li>
</ul>

<p>You can find the entire source for <code>game.js</code> and this project at <a href="https://github.com/androidfanatic/aframe-maze-vr/">https://github.com/androidfanatic/aframe-maze-vr/</a>.</p>

<p>A-Frame makes building VR scenes extremely easy. For example, take a look at the addWall method:</p>

<pre><code>function addWall(x, y, z, h, w, d) {
    var wall = document.createElement('a-entity');
    wall.setAttribute(&quot;position&quot;, x + &quot; &quot; + y + &quot; &quot; + z);
    wall.setAttribute(&quot;geometry&quot;, &quot;height:&quot; + h + &quot;;width:&quot; + w + &quot;;depth:&quot; + d + &quot;;&quot;);
    wall.setAttribute(&quot;static-body&quot;, &quot;shape: box;&quot;);
    document.querySelector('a-scene').appendChild(wall);
}
</code></pre>

<h2 id="applying-textures-to-a-3d-object">Applying textures to a 3D object:</h2>

<p>Load 2D images or texture as assets:</p>

<pre><code>&lt;a-scene ... &gt;
    &lt;a-assets&gt;
        &lt;img id=&quot;wall&quot; src=&quot;img/wall.jpg&quot;&gt;
        &lt;img id=&quot;sand&quot; src=&quot;img/sand.jpg&quot;&gt;
    &lt;/a-assets&gt;
    ...
&lt;/a-scene&gt;
</code></pre>

<p>Apply texture to ground and wall components as follows:</p>

<pre><code>&lt;a-grid static-body material=&quot;src: #sand&quot;&gt;&lt;/a-grid&gt;

// and

function addWall(x, y, z, h, w, d) {
    ...
    wall.setAttribute(&quot;material&quot;, &quot;src: #wall&quot;);
    ...
}
</code></pre>

<p>And thus we&rsquo;ve finished composing a 3D scene for maze game with shapes, texture, physics and user controls with few lines of code!</p>

<p>Go ahead and give it a try. Click below to start. Press <code>esc</code> to exit.</p>

<iframe src="https://manishraj.dev/blog/html/aframe" style="width: 640px; height: 320px; border: 0px; margin: auto; display: block;" id="play_iframe"></iframe>

<p>Play in <a href="https://manishraj.dev/blog/html/aframe">fullscreen</a>.</p>

<p>Check this project at: <a href="https://github.com/androidfanatic/aframe-maze-vr">https://github.com/androidfanatic/aframe-maze-vr</a></p>

<h2 id="tips-for-debugging">Tips for debugging:</h2>

<ul>
<li>Use the inspector bundled wit A-Frame by pressing <code>ctrl + alt + i</code>. You can then pick elements and modify/debug their properties. Once happy with the scene,  you can also export it to HTML from the inspector.</li>
</ul>

<video src="https://manishraj.dev/blog/vid/aframe_debug.mp4" id="inspector_vid" loop style="width: 100%; display: block; margin: auto;"></video>

<ul>
<li><p>Add <code>stats</code> attribute to a-scene to keep an eye on framerate and other params.</p></li>

<li><p>Use dev tools and browser console.</p></li>
</ul>

<h2 id="links">Links:</h2>

<ul>
<li><p><a href="https://aframe.io/">https://aframe.io/</a></p></li>

<li><p><a href="https://aframe.io/aframe-school/">https://aframe.io/aframe-school/</a></p></li>

<li><p><a href="https://github.com/donmccurdy/aframe-extras">https://github.com/donmccurdy/aframe-extras</a></p></li>
</ul>

<script>
window.addEventListener('load', function() {      
    var isMobile = window.matchMedia("only screen and (max-width: 760px)");

    if (isMobile.matches) {
        document.querySelector("#play_iframe").remove();
        document.querySelector("#inspector_vid").setAttribute('controls', 'true');
    } else {
        document.querySelector("#inspector_vid").play();
    }
 });
</script>
</div>

		<p class="meta">Posted on <span class="postdate">23. September 2017</span></p>
	</article>

			</div>

			<footer id="footer">
				<p class="copyright">
					
						 
					
				</p>
			</footer>
		</div>

		<div style="text-align: center;">
  <a href="https://www.linkedin.com/in/manish-raj/" target="_blank">
    <img style="filter: invert(100%) sepia(5%) saturate(753%) hue-rotate(236deg) brightness(117%) contrast(100%); width: 20px; height: 20px;" 
      src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjxzdmcgaGVpZ2h0PSI1MHB4IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1MCA1MCIgd2lkdGg9IjUwcHgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6c2tldGNoPSJodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2gvbnMiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48dGl0bGUvPjxkZWZzLz48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIj48ZyBmaWxsPSIjMDAwMDAwIiBpZD0iTGlua2VkSW4iPjxwYXRoIGQ9Ik0yNSw1MCBDMzguODA3MTE5NCw1MCA1MCwzOC44MDcxMTk0IDUwLDI1IEM1MCwxMS4xOTI4ODA2IDM4LjgwNzExOTQsMCAyNSwwIEMxMS4xOTI4ODA2LDAgMCwxMS4xOTI4ODA2IDAsMjUgQzAsMzguODA3MTE5NCAxMS4xOTI4ODA2LDUwIDI1LDUwIFogTTI1LDQ3IEMzNy4xNTAyNjUxLDQ3IDQ3LDM3LjE1MDI2NTEgNDcsMjUgQzQ3LDEyLjg0OTczNDkgMzcuMTUwMjY1MSwzIDI1LDMgQzEyLjg0OTczNDksMyAzLDEyLjg0OTczNDkgMywyNSBDMywzNy4xNTAyNjUxIDEyLjg0OTczNDksNDcgMjUsNDcgWiBNMTQsMjAuMTE4MDQ3OSBMMTQsMzQuNjU4MTgzNCBMMTguNzEwMDg1MSwzNC42NTgxODM0IEwxOC43MTAwODUxLDIwLjExODA0NzkgTDE0LDIwLjExODA0NzkgWiBNMTYuNjY0Njk2MiwxMyBDMTUuMDUzNDA1OCwxMyAxNCwxNC4wODU4NjExIDE0LDE1LjUxMTUxMjIgQzE0LDE2LjkwNzYzMzEgMTUuMDIyMjcxMSwxOC4wMjQ3NjE0IDE2LjYwMzU1NTYsMTguMDI0NzYxNCBMMTYuNjMzNjU1NiwxOC4wMjQ3NjE0IEMxOC4yNzU5ODY3LDE4LjAyNDc2MTQgMTkuMjk4ODIyMiwxNi45MDc2MzMxIDE5LjI5ODgyMjIsMTUuNTExNTEyMiBDMTkuMjY4MjUxOSwxNC4wODU4NjExIDE4LjI3NTk4NjcsMTMgMTYuNjY0Njk2MiwxMyBaIE0zMC41NzY5MjEzLDIwLjExODA0NzkgQzI4LjA3NjE3NiwyMC4xMTgwNDc5IDI2Ljk1NjU1MDEsMjEuNTI5MzE5OSAyNi4zMzE0MTA4LDIyLjUxOTM1MjcgTDI2LjMzMTQxMDgsMjAuNDU5ODY0NCBMMjEuNjIwNzYxNCwyMC40NTk4NjQ0IEMyMS42ODI4NDI3LDIxLjgyNDIzNTYgMjEuNjIwNzYxNCwzNSAyMS42MjA3NjE0LDM1IEwyNi4zMzE0MTA4LDM1IEwyNi4zMzE0MTA4LDI2Ljg3OTU4ODcgQzI2LjMzMTQxMDgsMjYuNDQ1MDMyIDI2LjM2MTk4MTIsMjYuMDExNTM2OCAyNi40ODY1MTk5LDI1LjcwMDQwODQgQzI2LjgyNjkzMiwyNC44MzIyNiAyNy42MDIwMDY5LDIzLjkzMzQyMzMgMjguOTAzMjY3NCwyMy45MzM0MjMzIEMzMC42MDgzMzgxLDIzLjkzMzQyMzMgMzEuMjg5OTE0OSwyNS4yNjY3MjAyIDMxLjI4OTkxNDksMjcuMjIwNjMzMyBMMzEuMjg5OTE0OSwzNC45OTk2MTQgTDM1Ljk5OTgxMTksMzQuOTk5NjE0IEwzNiwyNi42NjI3NDQ2IEMzNiwyMi4xOTY2NDM5IDMzLjY3NjM3NDMsMjAuMTE4MDQ3OSAzMC41NzY5MjEzLDIwLjExODA0NzkgWiBNMzAuNTc2OTIxMywyMC4xMTgwNDc5IiBpZD0iT3ZhbC0xIi8+PC9nPjwvZz48L3N2Zz4=" 
      alt="Linkedin"
    />
  </a>
</div>
	</body>
</html>
